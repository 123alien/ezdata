# TrustRAG 外部服务模块

## 📋 模块概述

这是 EZDATA 系统中的 TrustRAG 外部服务模块，提供了完整的智能问答和知识检索功能。

## 🏗️ 模块结构

```
web/src/views/rag/external/
├── api/                    # API 接口
│   └── external-rag.api.ts
├── components/             # 组件
│   ├── ServiceStatus.vue   # 服务状态组件
│   ├── ChatInterface.vue   # 聊天界面组件
│   └── KnowledgeSearch.vue # 知识检索组件
├── data/                   # 数据定义
│   └── external-rag.data.ts
├── index.vue               # 主页面
└── README.md               # 说明文档
```

## 🚀 功能特性

### 1. 服务状态监控
- 实时显示 TrustRAG 服务状态
- 支持手动初始化和连接测试
- 显示组件状态和端点信息

### 2. 智能问答
- 基于汽车操作手册的智能问答
- 支持预设问题快速访问
- 对话记录管理和导出
- 支持重新生成响应

### 3. 知识检索
- 关键词检索和相似度匹配
- 可调节的相似度阈值
- 搜索结果分页和导出
- 搜索历史记录

## 💻 使用方法

### 访问路径
```
/rag/external
```

### 主要操作
1. **检查服务状态**：确保 TrustRAG 服务正常运行
2. **初始化服务**：如果状态显示"初始化中"，点击初始化按钮
3. **开始对话**：在左侧聊天界面输入问题
4. **知识检索**：在右侧搜索界面进行知识检索

## 🔧 技术实现

### 组件架构
- **ServiceStatus**: 服务状态监控和管理
- **ChatInterface**: 聊天对话界面
- **KnowledgeSearch**: 知识检索界面
- **主页面**: 整合所有组件，提供完整功能

### API 接口
- 健康检查：`/api/external/rag/health`
- 初始化：`/api/external/rag/initialize`
- 聊天：`/api/external/rag/chat`
- 检索：`/api/external/rag/search`
- 状态：`/api/external/rag/status`

### 数据流
```
用户操作 → 组件事件 → API 调用 → 后端转发 → TrustRAG 服务 → 响应处理 → 界面更新
```

## 📱 界面预览

### 服务状态区域
- 服务状态指示器
- 组件状态标签
- 操作按钮（刷新、初始化、测试）

### 聊天界面
- 预设问题标签
- 对话消息列表
- 输入框和发送按钮
- 操作按钮（清空、导出）

### 知识检索
- 搜索参数配置
- 搜索结果列表
- 搜索统计信息
- 操作按钮（清空、导出）

## ⚠️ 注意事项

1. **服务依赖**：需要 TrustRAG 服务正常运行在 `http://localhost:8217`
2. **网络连接**：确保 EZDATA 后端可以访问 TrustRAG 服务
3. **权限控制**：模块遵循 EZDATA 的权限控制机制
4. **响应时间**：首次查询可能需要较长时间，后续查询会更快

## 🔍 故障排除

### 常见问题
1. **服务连接失败**：检查 TrustRAG 服务状态和网络连接
2. **搜索无结果**：调整相似度阈值或检查服务初始化状态
3. **响应缓慢**：检查服务性能和网络延迟

### 调试方法
1. 查看浏览器控制台错误信息
2. 检查后端日志
3. 使用连接测试功能诊断问题

## 📈 扩展功能

### 计划中的功能
- 多语言支持
- 高级搜索过滤器
- 结果排序和过滤
- 批量操作支持
- 性能监控和统计

### 自定义配置
- 可配置的服务地址
- 可调整的超时设置
- 可自定义的界面主题
- 可扩展的预设问题

## 📞 技术支持

如有问题或建议，请联系开发团队或查看相关文档。
